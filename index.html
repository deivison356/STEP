<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Prova Online</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      transition: background-color 0.3s, color 0.3s;
    }
    .dark-mode {
      background-color: #121212;
      color: #ffffff;
    }
    .container {
      text-align: center;
      padding: 20px;
    }
    iframe {
      width: 100%;
      height: 600px;
      border: none;
      display: none;
    }
    #calculator {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #f1f1f1;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 8px;
      width: 200px;
    }
    #calculator.dark-mode {
      background: #333;
      color: white;
    }
    .calc-row {
      display: flex;
      justify-content: space-between;
      margin: 2px 0;
    }
    .calc-row button {
      width: 45px;
      height: 30px;
    }
    #modeToggle {
      position: fixed;
      top: 20px;
      right: 20px;
    }
    #timer {
      font-size: 24px;
      margin-top: 20px;
    }
    #senha {
      margin: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Prova Online</h1>
    <div id="senha">Senha: trilha082025</div>
    <button onclick="startExam()">Iniciar Prova</button>
    <div id="timer"></div>
    <iframe id="formFrame" src="https://forms.gle/vrDkxpUwM8NhZ1VZ7"></iframe>
  </div>

  <!-- Calculadora -->
  <div id="calculator">
    <input type="text" id="display" disabled style="width: 100%; margin-bottom: 5px;">
    <div class="calc-row">
      <button onclick="appendCalc('+')">+</button>
      <button onclick="appendCalc('-')">-</button>
      <button onclick="appendCalc('*')">*</button>
      <button onclick="appendCalc('/')">/</button>
    </div>
    <div class="calc-row">
      <button onclick="appendCalc('7')">7</button>
      <button onclick="appendCalc('8')">8</button>
      <button onclick="appendCalc('9')">9</button>
      <button onclick="clearCalc()">C</button>
    </div>
    <div class="calc-row">
      <button onclick="appendCalc('4')">4</button>
      <button onclick="appendCalc('5')">5</button>
      <button onclick="appendCalc('6')">6</button>
      <button onclick="calculate()">=</button>
    </div>
    <div class="calc-row">
      <button onclick="appendCalc('1')">1</button>
      <button onclick="appendCalc('2')">2</button>
      <button onclick="appendCalc('3')">3</button>
      <button onclick="appendCalc('0')">0</button>
    </div>
  </div>

  <!-- Modo escuro -->
  <button id="modeToggle" onclick="toggleDarkMode()">ðŸŒ™</button>

  <script>
    let totalSeconds = 30 * 60; // 30 minutos
    let timerInterval;
    let examStarted = false;
    let penalized = 0;

    function updateTimer() {
      let minutes = Math.floor(totalSeconds / 60);
      let seconds = totalSeconds % 60;
      document.getElementById('timer').textContent = `Tempo restante: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      if (totalSeconds <= 0) {
        clearInterval(timerInterval);
        alert("Tempo encerrado!");
        document.getElementById("formFrame").style.display = "none";
      }
      totalSeconds--;
    }

    function startExam() {
      if (examStarted) return;
      const senha = prompt("Digite a senha para iniciar:");
      const data = new Date();
      const expected = `trilha${(data.getMonth() + 1).toString().padStart(2, '0')}${data.getFullYear()}`;
      if (senha !== expected) {
        alert("Senha incorreta!");
        return;
      }
      examStarted = true;
      document.getElementById("formFrame").style.display = "block";
      updateTimer();
      timerInterval = setInterval(updateTimer, 1000);
    }

    // PenalizaÃ§Ã£o por troca de aba
    document.addEventListener("visibilitychange", function () {
      if (document.hidden && examStarted) {
        if (totalSeconds <= 600) { // Se faltar 10 minutos ou menos
          totalSeconds -= 10 * 60;
        } else {
          totalSeconds -= 10 * 60;
        }
        const audio = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
        audio.play();
        alert("VocÃª saiu da aba! PenalizaÃ§Ã£o de 10 minutos aplicada.");
      }
    });

    // Calculadora
    let display = document.getElementById("display");
    function appendCalc(value) {
      display.value += value;
    }
    function clearCalc() {
      display.value = "";
    }
    function calculate() {
      try {
        display.value = eval(display.value);
      } catch {
        display.value = "Erro";
      }
    }

    // Modo escuro
    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
      document.getElementById("calculator").classList.toggle("dark-mode");
    }
  </script>
</body>
</html>
